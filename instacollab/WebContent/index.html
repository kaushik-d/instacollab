<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Start Collaboration Now</title>
<link rel="stylesheet" type="text/css" href="index.css?v=1.0">
<link
	href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"
	rel="stylesheet">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src='http://connect.facebook.net/en_US/all.js'></script>
<script>
	var startClicked = false;
	var whiteboardClicked = false;
	var presentationClicked = false;

	var meetingRoomData = {};
	var isRoomCreated = false;

	$(document).ready(
			function() {
				$("#Start_Button").click(function() {
					if (!startClicked) {
						startClicked = true;
						$("#ShareMeetingRoomNumInput").val("");
						$("#Share_Action_Area").slideUp("slow");
						$("#JoinMeetingRoomNumInput").val("");
						$("#Join_Action_Area").slideUp("slow");
						$("#Start_Action_Area").slideDown("slow");
					} else if (whiteboardClicked) {
						whiteboardClicked = false;
						$("#Start_WhiteBoard").slideUp("slow", function() {
							$("#Start_Action_Area").slideDown("slow");
						});
					} else if (presentationClicked) {
						presentationClicked = false;
						$("#Start_Presentation").slideUp("slow", function() {
							$("#Start_Action_Area").slideDown("slow");
						});
					} else {
						startClicked = false;
						$("#Start_Action_Area").slideUp("slow");
					}
				});
				var delay=1000, setTimeoutConst;
				$("#Start_Button").hover(
						function(){
						setTimeoutConst = setTimeout(
						function() {
							$("#Start_Message_Area").removeClass(
									"Message_Area_Start_Clear").addClass(
									"Message_Area_Start_Focus").text(
									"Start a meeting");
						},delay);},
						function() {
							clearTimeout(setTimeoutConst );
							$("#Start_Message_Area").removeClass(
									"Message_Area_Start_Focus").addClass(
									"Message_Area_Start_Clear").text("");
						});

				$("#whiteboard").click(function() {
					whiteboardClicked = true;
					$("#Start_Action_Area").slideUp("slow", function() {
						$("#Start_WhiteBoard").slideDown("slow");
					});
				});
				$("#presentation").click(function() {
					presentationClicked = true;
					$("#Start_Action_Area").slideUp("slow", function() {
						$("#Start_Presentation").slideDown("slow");
					});
				});
				
				$("Whiteboard_Cancel").click(function() {
					whiteboardClicked = false;
					$(this).closest('form').find("input[type=text], textarea, input[type=email]").val("");
					$("#Start_WhiteBoard").slideUp("slow", function() {
						$("#Start_Action_Area").slideDown("slow");
					});
				});
				
				$("Presentation_Cancel").click(function() {
					whiteboardClicked = false;
					$(this).closest('form').find("input[type=text], textarea, input[type=email]").val("");
					$("#Start_WhiteBoard").slideUp("slow", function() {
						$("#Start_Action_Area").slideDown("slow");
					});
				});

				$("#PresentationForm").submit(StartPresentation);
				$("#WhiteboardForm").submit(StartWhiteboard);

				$("#Share_Button").click(function() {
					//presentationClicked = true;
					$("#Share_Action_Area").slideToggle("slow", function() {
					});
				});
				
				$("#Share_Button").mouseover(
						function() {
							$("#Share_Message_Area").removeClass(
									"Message_Area_Start_Clear").addClass(
									"Message_Area_Start_Focus").text(
									"Share your meeting room");
						});
				$("#Share_Button").mouseout(
						function() {
							$("#Share_Message_Area").removeClass(
									"Message_Area_Start_Focus").addClass(
									"Message_Area_Start_Clear").text("");
						});

				$("#Join_Button").mouseover(
						function() {
							$("#Join_Message_Area").removeClass(
									"Message_Area_Start_Clear").addClass(
									"Message_Area_Start_Focus").text(
									"Join a meeting room");
						});
				$("#Join_Button").mouseout(
						function() {
							$("#Join_Message_Area").removeClass(
									"Message_Area_Start_Focus").addClass(
									"Message_Area_Start_Clear").text("");
						});
				
				$("#Join_Button").click(function() {
					//presentationClicked = true;
					$("#Join_Action_Area").slideToggle("slow");
				});
				
				$(document).ajaxStart(function(){ 
						$("#Start_Action_Area_holder").addClass("holder_ajax_load");
						$("#Share_Action_Area_holder").addClass("holder_ajax_load");
						$("#Join_Action_Area_holder").addClass("holder_ajax_load");
					}).ajaxStop(function(){ 
						$("#Start_Action_Area_holder").removeClass("holder_ajax_load");
						$("#Share_Action_Area_holder").removeClass("holder_ajax_load");
						$("#Join_Action_Area_holder").removeClass("holder_ajax_load");
					});

			});

	StartPresentation = function(evt) {
		var formElement = document.getElementById("PresentationForm");
		var data = new FormData(formElement);
		data.append("isPresentation", "true");
		data.append("presentationURI", "NotAvailable");
		data.append("functName", "createRoom");
		presentationClicked = false;
		$("#Start_Presentation").slideUp("slow");
		StartSubmit(evt, data);
	}

	StartWhiteboard = function(evt) {
		var formElement = document.getElementById("WhiteboardForm");
		var data = new FormData(formElement);
		data.append("isPresentation", "false");
		data.append("presentationURI", "NotAPresentation");
		data.append("functName", "createRoom");
		whiteboardClicked = false;
		$("#Start_WhiteBoard").slideUp("slow");
		StartSubmit(evt, data);
	}

	StartSubmit = function(evt, data) {
		var url = "login";
		$
				.ajax({
					type : "POST",
					url : url,
					data : data,
					cache : false,
					contentType : false,
					processData : false,
					success : function(data) {
						meetingRoomData = data;
						isRoomCreated = true;
						//$("#Start_Action_Area_holder").removeClass("holder_ajax_load");
						//document.getElementById("Start_Action_Area").innerHTML = '';
						$("#ShareMeetingRoomNumInput").val(meetingRoomData.roomNumber);
						$("#Share_Action_Area").slideDown("slow");
						$("#JoinMeetingRoomNumInput").val(meetingRoomData.roomNumber);
						$("#Join_Action_Area").slideDown("slow");
						startClicked = false;
					}
				});

		evt.preventDefault();		
		return false; // avoid to execute the actual submit of the form.
	}

	function Join(joinButton) {
		if (isRoomCreated) {
			xmlhttp = new XMLHttpRequest();
			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
					window.location = xmlhttp.responseText;
					isRoomCreated = false;
					startClicked = true;
				}
			}
			xmlhttp.open("POST", "joinMeeting", true);
			var params = "data=" + encodeURIComponent(JSON.stringify({
				functName : "joinMeeting",
				isPresentation : false,
				name : meetingRoomData.name,
				topic : meetingRoomData.topic,
				roomNumber : meetingRoomData.roomNumber
			}));
			xmlhttp.setRequestHeader("Content-type",
					"application/x-www-form-urlencoded");
			xmlhttp.send(params);
		}
	}

	var popupCenter = function(url, title, w, h) {
		// Fixes dual-screen position                         Most browsers      Firefox
		var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft
				: screen.left;
		var dualScreenTop = window.screenTop !== undefined ? window.screenTop
				: screen.top;

		var width = window.innerWidth ? window.innerWidth
				: document.documentElement.clientWidth ? document.documentElement.clientWidth
						: screen.width;
		var height = window.innerHeight ? window.innerHeight
				: document.documentElement.clientHeight ? document.documentElement.clientHeight
						: screen.height;

		var left = ((width / 2) - (w / 2)) + dualScreenLeft;
		var top = ((height / 3) - (h / 3)) + dualScreenTop;

		var newWindow = window.open(url, title, 'scrollbars=yes, width=' + w
				+ ', height=' + h + ', top=' + top + ', left=' + left);

		// Puts focus on the newWindow
		if (window.focus) {
			newWindow.focus();
		}
	};

	//  =======================================

	window
			.addEventListener(
					'load',
					function(e) {
						window.applicationCache
								.addEventListener(
										'updateready',
										function(e) {
											if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
												// Browser downloaded a new app cache.
												// Swap it in and reload the page to get the new hotness.
												window.applicationCache
														.swapCache();
												// if (confirm('A new version of this site is available. Load it?')) {
												window.location.reload();
												// }
											} else {
												// Manifest didn't changed. Nothing new to server.
											}
										}, false);

					}, false);
</script>

</head>
<body>
	<!--  Facebook -->
	<div id="fb-root"></div>
	<script>
		(function(d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id))
				return;
			js = d.createElement(s);
			js.id = id;
			js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.4&appId=312941762107579";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>
	<!--  Facebook ends -->

	<div id="background">
		<div id="HeaderDiv">
			<a>Demo</a> |
			<a>Help</a> |
    		<a>Feedback</a> |
    		<a>Terms and conditions</a>
    	</div>
		<div id=button_holder>
			<div id="Start_Message_Area" class="Message_Area_Start_Clear"></div>
			<div id="Start_div">
				<button id="Start_Button">Start</button>
			</div>
			<div id="Start_Action_Area_holder" class="Action_Area_holder">
				<div id="Start_Action_Area" class="Start_Action">
					<button id="whiteboard" style="width : 100px" >Whiteboard</button>
					<button id="presentation" style="width : 100px">Presentation</button>
				</div>
				<div id="Start_WhiteBoard" class="Start_Action">
					<form action="login" method="post" enctype="multipart/form-data"
						id="WhiteboardForm">
						<div id="WhiteboardFormHolder" class="holder">
							<table>
								<tr>
									<td><label for="topic">Topic:</label></td>
									<td><input type="text" name="topic"
										placeholder="Meeting topic" required /></td>
								</tr>
								<tr>
									<td><label for="name">Name:</label></td>
									<td><input type="text" name="name"
										placeholder="First name and last name" required /></td>
								</tr>
								<tr>
									<td><label for="email">E-mail:</label></td>
									<td><input type="email" name="email"
										placeholder="e-mail@domain.com" required /></td>
								</tr>
								<tr>
									<td></td>
									<td><input type="submit" value="Submit" />
									<input type="reset" value="Reset" />
									<input type="reset" id="Whiteboard_Cancel" value="Cancel" />
								</tr>
							</table>
						</div>
					</form>
				</div>
				<div id="Start_Presentation" class="Start_Action">
					<form action="login" method="post" enctype="multipart/form-data"
						id="PresentationForm">
						<div id="PresentationFormHolder" class="holder">
							<table>
								<tr>
									<td><label for="topic">Topic:</label></td>
									<td><input type="text" name="topic"
										placeholder="Meeting topic" required /></td>
								</tr>
								<tr>
									<td><label for="name">Name:</label></td>
									<td><input type="text" name="name"
										placeholder="First name and last name" required /></td>
								</tr>
								<tr>
									<td><label for="email">E-mail:</label></td>
									<td><input type="email" name="email"
										placeholder="e-mail@domain.com" required /></td>
								</tr>
								<tr>
									<td><label for="presentationFile">Presentation
											slides:</label></td>
									<td><input type="file" name="presentationFile" accept="application/vnd.openxmlformats-officedocument.presentationml.presentation,application/pdf"/></td>
								<tr>
									<td></td>
									<td><input type="submit" value="Submit" />
									<input type="reset" value="Reset" />
									<input type="reset" id="Presentation_Cancel" value="Cancel" />
								</tr>
							</table>
						</div>
					</form>
				</div>
			</div>

			<div id="Share_Message_Area" class="Message_Area_Start_Clear"></div>
			<div id="Share_div">
				<button id="Share_Button">Share</button>
			</div>

			<div id="Share_Action_Area_holder" class="Action_Area_holder"  style="height:100px">
				<div id="Share_Action_Area" class="Start_Action">
					<div id="Join_Holder" style="text-align: center;" class="holder">
						<table>
							<tr>
								<td><label for="ShareMeetingRoomNumInput">Meeting room#:</label>
									<input type="text" name="MeetingRoom" id="ShareMeetingRoomNumInput" /></td>
							</tr>
							<tr>
								<td>
									<ul class="social-icons">
										<!-- Facebook Button-->
										<li class="social-icon facebook"><a
											onclick="javascript:popupCenter('https://www.facebook.com/sharer/sharer.php?u=www.test.com&amp;appId=XXX_YOUR_FACEBOOK_APP_ID','Facebook Share', '540', '400');return false;"
											href="https://www.facebook.com/sharer/sharer.php?u=www.test.com&amp;appId=XXX_YOUR_FACEBOOK_APP_ID"
											target="blank"><i class="fa fa-facebook"></i> Share </a></li>
										<!-- Twitter Button -->
										<li class="social-icon twitter"><a
											onclick="javascript:popupCenter('https://twitter.com/share?&amp;url=www.test.com&amp;text=TestTitle','Tweet', '540', '400');return false;"
											href="https://twitter.com/share?&amp;url=www.test.com&amp;text=www.test.com"
											target="blank"><i class="fa fa-twitter"></i> Tweet </a></li>
										<!-- Google + Button-->
										<li class="social-icon google-plus"><a
											onclick="javascript:popupCenter('https://plus.google.com/share?url=www.test.com','Share on Google+', '600', '600');return false;"
											href="https://plus.google.com/share?url=www.test.com"
											target="blank"><i class="fa fa-google-plus"></i> Google+</a></li>
										<!-- Flattr Button
						<li class="social-icon flattr"><a
							onclick="javascript:popupCenter('https://flattr.com/submit/auto?title=TestTitle&language=de_DE&&category=text','Support with Flattr', '680', '400');return false;"
							href="https://flattr.com/submit/auto?url=www.test.comm&title=TestTitle&language=en_EN&&category=text"
							target="blank" rel="nofollow">Flattr</a></li>
							-->
										<!-- LinkedIn Button -->
										<li class="social-icon linkedin"><a
											onclick="javascript:popupCenter('http://www.linkedin.com/shareArticle?mini=true&amp;url=www.TestUrl.com&amp;title=Title&amp;source=StieURl','Share on LinkedIn', '520', '570');return false;"
											href="http://www.linkedin.com/shareArticle?mini=true&amp;url=www.testUrl.com&amp;title=TitleTest&amp;source=UrlSource"
											target="blank"><i class="fa fa-linkedin"></i> LinkedIn </a></li>
									</ul>
								<td>
							</tr>
						</table>
					</div>
				</div>
			</div>


			<div id="Join_Message_Area" class="Message_Area_Start_Clear"></div>
			<div id="Join_div">
				<button id="Join_Button">Join</button>
			</div>
			<div id="Join_Action_Area_holder" class="Action_Area_holder"  style="height:100px">
				<div id="Join_Action_Area" class="Start_Action">
					<div id="Join_Holder" style="text-align: center;" class="holder">
						<form action="canvas.jsp" method="get" id="JoinForm">
							<table>
								<tr>
									<td><label for="JoinMeetingRoomNumInput">Meeting
											room#:</label> <input type="text" name="room"
										id="JoinMeetingRoomNumInput" required/></td>
								</tr>
								<tr style="float: left">
									<td><input type="submit" value="Submit" /></td>
									<td><input type="reset" value="Reset" /></td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
		</div>

		<!-- <video autoplay loop poster="polina.jpg" id="bgvid"> -->
		<!--  
		<video autoplay loop id="bgvid">
			<source src="images/EarthSpin.mov" type="video/mp4">
		</video>
		-->

	</div>
</body>


</html>